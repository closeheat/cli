var Authorized,Cloner,Git,Log,Promise,Urls;Promise=require("bluebird"),Git=require("git-wrapper"),Authorized=require("./authorized"),Urls=require("./urls"),Log=require("./log"),module.exports=Cloner=function(){function e(){}return e.prototype.clone=function(e){return Log.logo(),Log.spin("Getting application data for "+e+"."),this.getAppData(e).then(function(o){return function(t){return Log.stop(),Log.br(),Log.spin("Cloning GitHub repository from "+t.github_repo+"."),o.execCloning(t.github_repo,t.default_branch,e).then(function(){return Log.stop(),Log.inner("Cloned the app code to directory '"+e+"'."),Log.br(),Log.line("Run the server by typing:"),Log.code(["cd "+e,"closeheat"]),Log.br(),Log.p("The quickest way to deploy changes to closeheat.com and GitHub is with:"),Log.secondaryCode("closeheat deploy"),Log.br(),Log.p("For more awesome tricks type:"),Log.secondaryCode("closeheat help")})}}(this))["catch"](function(e){return Log.error(e)})},e.prototype.getAppData=function(e){return new Promise(function(o,t){return Authorized.request({url:Urls.appData(e),method:"get"},function(r,n){var i,u;if(r)return t(r);try{i=JSON.parse(n.body).app}catch(c){return u=c,t("App named '"+e+"' does not exist or the server is down.")}return o(i)})})},e.prototype.execCloning=function(e,o,t){return this.git=new Git,new Promise(function(o,r){return(new Git).exec("clone",["git@github.com:"+e+".git",t],function(e){return e?r(e):o()})})},e}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsb25lci5jb2ZmZWUiLCJjbG9uZXIuanMiXSwibmFtZXMiOlsiQXV0aG9yaXplZCIsIkNsb25lciIsIkdpdCIsIkxvZyIsIlByb21pc2UiLCJVcmxzIiwicmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJwcm90b3R5cGUiLCJjbG9uZSIsImFwcF9uYW1lIiwibG9nbyIsInNwaW4iLCJ0aGlzIiwiZ2V0QXBwRGF0YSIsInRoZW4iLCJfdGhpcyIsImFwcCIsInN0b3AiLCJiciIsImdpdGh1Yl9yZXBvIiwiZXhlY0Nsb25pbmciLCJkZWZhdWx0X2JyYW5jaCIsImlubmVyIiwibGluZSIsImNvZGUiLCJwIiwic2Vjb25kYXJ5Q29kZSIsImVyciIsImVycm9yIiwicmVzb2x2ZSIsInJlamVjdCIsInJlcXVlc3QiLCJ1cmwiLCJhcHBEYXRhIiwibWV0aG9kIiwicmVzcCIsImUiLCJKU09OIiwicGFyc2UiLCJib2R5IiwiX2Vycm9yIiwiYnJhbmNoIiwiZ2l0IiwiZXhlYyJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsWUFBQUMsT0FBQUMsSUFBQUMsSUFBQUMsUUFBQUMsSUFBQUQsU0FBVUUsUUFBUSxZQUFsQkosSUFDTUksUUFBUSxlQURkTixXQUdhTSxRQUFRLGdCQUhyQkQsS0FJT0MsUUFBUSxVQUpmSCxJQUtNRyxRQUFRLFNBTGRDLE9BT09DLFFBQ0RQLE9BQUEsV0NLSixRQUFTQSxNQThEVCxNRGxFQUEsR0FBQVEsVUFBQUMsTUFBTyxTQUFDQyxHQ1NOLE1EUkFSLEtBQUlTLE9BQ0pULElBQUlVLEtBQU0sZ0NBQStCRixFQUFTLEtBRWxERyxLQUFDQyxXQUFXSixHQUFVSyxLQUFLLFNBQUFDLEdDTXpCLE1ETnlCLFVBQUNDLEdDVXhCLE1EVEZmLEtBQUlnQixPQUNKaEIsSUFBSWlCLEtBQ0pqQixJQUFJVSxLQUFNLGtDQUFpQ0ssRUFBSUcsWUFBWSxLQUUzREosRUFBQ0ssWUFBWUosRUFBSUcsWUFBYUgsRUFBSUssZUFBZ0JaLEdBQVVLLEtBQUssV0NnQjdELE1EZkZiLEtBQUlnQixPQUNKaEIsSUFBSXFCLE1BQU8scUNBQW9DYixFQUFTLE1BRXhEUixJQUFJaUIsS0FDSmpCLElBQUlzQixLQUFLLDZCQUNUdEIsSUFBSXVCLE1BQ0QsTUFBS2YsRUFDTixjQUdGUixJQUFJaUIsS0FDSmpCLElBQUl3QixFQUFFLDJFQUNOeEIsSUFBSXlCLGNBQWMsb0JBRWxCekIsSUFBSWlCLEtBQ0pqQixJQUFJd0IsRUFBRSxpQ0FDTnhCLElBQUl5QixjQUFjLHNCQXRCS2QsT0F1QnpCLFNBQU0sU0FBQ2UsR0NFUCxNRERBMUIsS0FBSTJCLE1BQU1ELE1BNUJkNUIsRUFBQVEsVUE4QkFNLFdBQVksU0FBQ0osR0NJWCxNREhJLElBQUFQLFNBQVEsU0FBQzJCLEVBQVNDLEdDSXBCLE1ESEFoQyxZQUFXaUMsU0FBUUMsSUFBSzdCLEtBQUs4QixRQUFReEIsR0FBV3lCLE9BQVEsT0FBTyxTQUFDUCxFQUFLUSxHQUNuRSxHQUFBbkIsR0FBQW9CLENBQUEsSUFBc0JULEVBQXRCLE1BQU9HLEdBQU9ILEVBRWQsS0FDRVgsRUFBTXFCLEtBQUtDLE1BQU1ILEVBQUtJLE1BQU12QixJQUQ5QixNQUFBd0IsR0FHRSxNQURJSixHQUFBSSxFQUNHVixFQUFRLGNBQWFyQixFQUFTLDJDQ1d2QyxNRFRBb0IsR0FBUWIsUUF4Q2RqQixFQUFBUSxVQTBDQWEsWUFBYSxTQUFDRCxFQUFhc0IsRUFBUWhDLEdDY2pDLE1EYkFHLE1BQUM4QixJQUFVLEdBQUExQyxLQUVQLEdBQUFFLFNBQVEsU0FBQzJCLEVBQVNDLEdDWXBCLE9EWEksR0FBQTlCLE1BQU0yQyxLQUFLLFNBQVcsa0JBQWlCeEIsRUFBWSxPQUFPVixHQUFXLFNBQUNrQixHQUN4RSxNQUFzQkEsR0FBZkcsRUFBT0gsR0FFZEUsU0NpQkM5QiIsImZpbGUiOiJjbG9uZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJQcm9taXNlID0gcmVxdWlyZSAnYmx1ZWJpcmQnXG5HaXQgPSByZXF1aXJlICdnaXQtd3JhcHBlcidcblxuQXV0aG9yaXplZCA9IHJlcXVpcmUgJy4vYXV0aG9yaXplZCdcblVybHMgPSByZXF1aXJlICcuL3VybHMnXG5Mb2cgPSByZXF1aXJlICcuL2xvZydcblxubW9kdWxlLmV4cG9ydHMgPVxuY2xhc3MgQ2xvbmVyXG4gIGNsb25lOiAoYXBwX25hbWUpIC0+XG4gICAgTG9nLmxvZ28oKVxuICAgIExvZy5zcGluIFwiR2V0dGluZyBhcHBsaWNhdGlvbiBkYXRhIGZvciAje2FwcF9uYW1lfS5cIlxuXG4gICAgQGdldEFwcERhdGEoYXBwX25hbWUpLnRoZW4oKGFwcCkgPT5cbiAgICAgIExvZy5zdG9wKClcbiAgICAgIExvZy5icigpXG4gICAgICBMb2cuc3BpbiBcIkNsb25pbmcgR2l0SHViIHJlcG9zaXRvcnkgZnJvbSAje2FwcC5naXRodWJfcmVwb30uXCJcblxuICAgICAgQGV4ZWNDbG9uaW5nKGFwcC5naXRodWJfcmVwbywgYXBwLmRlZmF1bHRfYnJhbmNoLCBhcHBfbmFtZSkudGhlbiA9PlxuICAgICAgICBMb2cuc3RvcCgpXG4gICAgICAgIExvZy5pbm5lciBcIkNsb25lZCB0aGUgYXBwIGNvZGUgdG8gZGlyZWN0b3J5ICcje2FwcF9uYW1lfScuXCJcblxuICAgICAgICBMb2cuYnIoKVxuICAgICAgICBMb2cubGluZSAnUnVuIHRoZSBzZXJ2ZXIgYnkgdHlwaW5nOidcbiAgICAgICAgTG9nLmNvZGUgW1xuICAgICAgICAgIFwiY2QgI3thcHBfbmFtZX1cIlxuICAgICAgICAgICdjbG9zZWhlYXQnXG4gICAgICAgIF1cblxuICAgICAgICBMb2cuYnIoKVxuICAgICAgICBMb2cucCAnVGhlIHF1aWNrZXN0IHdheSB0byBkZXBsb3kgY2hhbmdlcyB0byBjbG9zZWhlYXQuY29tIGFuZCBHaXRIdWIgaXMgd2l0aDonXG4gICAgICAgIExvZy5zZWNvbmRhcnlDb2RlICdjbG9zZWhlYXQgZGVwbG95J1xuXG4gICAgICAgIExvZy5icigpXG4gICAgICAgIExvZy5wICdGb3IgbW9yZSBhd2Vzb21lIHRyaWNrcyB0eXBlOidcbiAgICAgICAgTG9nLnNlY29uZGFyeUNvZGUgJ2Nsb3NlaGVhdCBoZWxwJ1xuICAgICkuY2F0Y2ggKGVycikgLT5cbiAgICAgIExvZy5lcnJvcihlcnIpXG5cbiAgZ2V0QXBwRGF0YTogKGFwcF9uYW1lKSAtPlxuICAgIG5ldyBQcm9taXNlIChyZXNvbHZlLCByZWplY3QpIC0+XG4gICAgICBBdXRob3JpemVkLnJlcXVlc3QgdXJsOiBVcmxzLmFwcERhdGEoYXBwX25hbWUpLCBtZXRob2Q6ICdnZXQnLCAoZXJyLCByZXNwKSAtPlxuICAgICAgICByZXR1cm4gcmVqZWN0KGVycikgaWYgZXJyXG5cbiAgICAgICAgdHJ5XG4gICAgICAgICAgYXBwID0gSlNPTi5wYXJzZShyZXNwLmJvZHkpLmFwcFxuICAgICAgICBjYXRjaCBlXG4gICAgICAgICAgcmV0dXJuIHJlamVjdChcIkFwcCBuYW1lZCAnI3thcHBfbmFtZX0nIGRvZXMgbm90IGV4aXN0IG9yIHRoZSBzZXJ2ZXIgaXMgZG93bi5cIilcblxuICAgICAgICByZXNvbHZlKGFwcClcblxuICBleGVjQ2xvbmluZzogKGdpdGh1Yl9yZXBvLCBicmFuY2gsIGFwcF9uYW1lKSAtPlxuICAgIEBnaXQgPSBuZXcgR2l0KClcblxuICAgIG5ldyBQcm9taXNlIChyZXNvbHZlLCByZWplY3QpIC0+XG4gICAgICBuZXcgR2l0KCkuZXhlYyAnY2xvbmUnLCBbXCJnaXRAZ2l0aHViLmNvbToje2dpdGh1Yl9yZXBvfS5naXRcIiwgYXBwX25hbWVdLCAoZXJyLCByZXNwKSAtPlxuICAgICAgICByZXR1cm4gcmVqZWN0KGVycikgaWYgZXJyXG5cbiAgICAgICAgcmVzb2x2ZSgpXG4iLG51bGxdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==